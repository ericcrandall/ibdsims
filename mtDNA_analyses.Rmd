---
title: "mtDNA analyses"
author: "Eric Crandall"
date: "September 9, 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library("hierfstat")
library("adegenet")
library("pegas")
library("ape")
```

## Loading simulated mtDNA data and making a haplotype network

```{r, echo=F}
#https://arundurvasula.wordpress.com/2016/02/24/haplotype-networks-in-r/

c <- ape::read.nexus.data("./pareto2_mtdnas/pareto2_AllIndividuals_rep1_loc8.nex")
d <- as.DNAbin(c)
e <- dist.dna(d)
h <- pegas::haplotype(d)
h <- sort(h, what = "label")
pop<-c(1,rep(5,20), rep(15,20), rep(25,20), rep(35,20), rep(45,20), rep(55,20), rep(65,20), rep(75,20), rep(85,20), rep(95,20))
net <- pegas::haploNet(h)
i<-stack(setNames(attr(h, "index"), rownames(h)))
ind.hap<- table(hap=i$ind, pop=pop)
plot(net, size=attr(net, "freq"), scale.ratio=0.2, pie=ind.hap)
legend(-100, -40, colnames(ind.hap), col=rainbow(ncol(ind.hap)), pch=19, ncol=2)
```

