---
title: "mtdna_marginal_likelihood"
author: "Eric Crandall"
date: "October 21, 2016"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
options(width = 100)
source("/Users/eric/github/ibdsims/migrate_harvester_functions.R")
models<-c("panmixia","5island","5stepping.stone","5stepping.stone1","10island","10stepping.stone","10stepping.stone1")
```

### Replicate 1 of panmictic model
```{r mtdna_panmixia, echo=F}
wd<-"/Users/eric/Datasets/simulations/ibdsim/migrate_singlepop_mtdna_results"
models<-c("panmixia","5island","5stepping.stone","5stepping.stone1","10island","10stepping.stone","10stepping.stone1")
setwd(wd)
marglikes<-migrate_harvester(wd=wd,models=models,multilocus = F)
bftable<-lapply(marglikes,bfcalcs,ml="bezier.corrected")
bftable
bfsum_pareto2<-bfcalcs_reps(bftable, models=models, reps=3)
print("Final Result - 3 reps")
bfsum_pareto2

```
This chose panmixia

### Replicates of mtDNA stepping stone model
```{r stepstone1, echo=F}
wd<-"/Users/eric/Datasets/simulations/ibdsim/mtdna_stepstone.01_rep1"
setwd(wd)
marglikes<-migrate_harvester(wd=wd,models=models,multilocus = F,quiet = T)
bftable<-lapply(marglikes,bfcalcs,ml="bezier.corrected")
bftable
```

```{r stepstone2, echo=F}
wd<-"/Users/eric/Datasets/simulations/ibdsim/mtdna_stepstone.01_rep2"
setwd(wd)
marglikes<-migrate_harvester(wd=wd,models=models,multilocus = F,quiet = T)
bftable<-lapply(marglikes,bfcalcs,ml="bezier.corrected")
bftable
```

```{r stepstone3, echo=F}
wd<-"/Users/eric/Datasets/simulations/ibdsim/mtdna_stepstone.01_rep3"
setwd(wd)
marglikes<-migrate_harvester(wd=wd,models=models,multilocus = F,quiet = T)
bftable<-lapply(marglikes,bfcalcs,ml="bezier.corrected")
bftable
```

```{r stepstone4, echo=F}
wd<-"/Users/eric/Datasets/simulations/ibdsim/mtdna_stepstone.01_rep4"
setwd(wd)
marglikes<-migrate_harvester(wd=wd,models=models,multilocus = F,quiet = T)
bftable<-lapply(marglikes,bfcalcs,ml="bezier.corrected")
bftable
```


```{r stepstone5, echo=F}
wd<-"/Users/eric/Datasets/simulations/ibdsim/mtdna_stepstone.01_rep5"
setwd(wd)
marglikes<-migrate_harvester(wd=wd,models=models,multilocus = F,quiet = T)
bftable<-lapply(marglikes,bfcalcs,ml="bezier.corrected")
bftable
```


```{r stepstone6, echo=F}
wd<-"/Users/eric/Datasets/simulations/ibdsim/mtdna_stepstone.01_rep6"
setwd(wd)
marglikes<-migrate_harvester(wd=wd,models=models,multilocus = F,quiet = T)
bftable<-lapply(marglikes,bfcalcs,ml="bezier.corrected")
bftable
```

```{r stepstone7, echo=F}
wd<-"/Users/eric/Datasets/simulations/ibdsim/mtdna_stepstone.01_rep7"
setwd(wd)
marglikes<-migrate_harvester(wd=wd,models=models,multilocus = F,quiet = T)
bftable<-lapply(marglikes,bfcalcs,ml="bezier.corrected")
bftable
```

```{r stepstone8, echo=F}
wd<-"/Users/eric/Datasets/simulations/ibdsim/mtdna_stepstone.01_rep8"
setwd(wd)
marglikes<-migrate_harvester(wd=wd,models=models,multilocus = F,quiet = T)
bftable<-lapply(marglikes,bfcalcs,ml="bezier.corrected")
bftable
```

```{r stepstone9, echo=F}
wd<-"/Users/eric/Datasets/simulations/ibdsim/mtdna_stepstone.01_rep9"
setwd(wd)
marglikes<-migrate_harvester(wd=wd,models=models,multilocus = F,quiet = T)
bftable<-lapply(marglikes,bfcalcs,ml="bezier.corrected")
bftable
```

```{r stepstone10, echo=F}
wd<-"/Users/eric/Datasets/simulations/ibdsim/mtdna_stepstone.01_rep10"
setwd(wd)
marglikes<-migrate_harvester(wd=wd,models=models,multilocus = F,quiet = T)
bftable<-lapply(marglikes,bfcalcs,ml="bezier.corrected")
bftable
```